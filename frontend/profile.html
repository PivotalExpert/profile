<html ng-app="sampleApp">
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
    <script src="https://cdn.firebase.com/js/client/2.2.4/firebase.js"></script>
    <script src="https://cdn.firebase.com/libs/angularfire/1.2.0/angularfire.min.js"></script>
    <script src="app.js"></script>
  </head>
  <body ng-controller="SampleCtrl">
    <div ng-hide="user">
        <button type="submit" ng-click="login()">Login</button>
    </div>
    <div ng-show="user">  
       Hi {{profile.user.diplayName}}. (edit)
       <button type="submit" ng-click="logout()">Logout</button>
    </div>
    <div ng-show="user && !user.publicId"> 
      <form ng-submit="addNewUserProfile()">
        Pick a unique username for ClassMentors. http://profile/<input ng-model="newProfileId" />
        <button type="submit">Save</button>
      </form>
    </div>
    
    <div ng-show="profile && !profile.services.codeCombat">
      <form ng-submit="addCodeCombat()">
        Enter your Code Combat username. <input ng-model="codeCombatUsername" />
        <button type="submit">Save</button>
      </form>
    </div>
    <div ng-show="profile && profile.services.codeCombat">
      CodeCombat profile for <a href="https://codecombat.com/user/{{profile.services.codeCombat.details.id}}" target="_blank">{{profile.services.codeCombat.details.id}}</a>
      (edit)
    </div>
    <div ng-show="profile && !profile.services.freeCodeCamp">
      <form ng-submit="addFreeCodeCamp()">
        Enter your Free Code Camp username. <input ng-model="freeCodeCampUsername" />
        <button type="submit">Save</button>
      </form>
    </div>
    <div ng-show="profile && profile.services.freeCodeCamp">
      FreeCodeCamp profile for <a href="https://www.freecodecamp.com/{{profile.services.freeCodeCamp.details.id}}" target="_blank">{{profile.services.freeCodeCamp.details.id}}</a>
      (edit)   
    </div>
    
    <button type="submit" ng-click="updateAllServices()">Update All Services</button>
    <button type="submit" ng-click="updateAllProfiles()">Update All Services for all users.</button>
    
   <h1>Profile Update Queue</h1>
      <table class="table table-striped">
      <tr>
        <th>Id</th>
        <th>Service</th>
        <th>State</th>
        <th>Progress</th>
         <th>State Changed</th>
      </tr>
      <tr ng-repeat="item in updateTasks">
        <td>
          {{item.id}}
        </td>
        <td>
            {{item.service}} 
        </td>
        <td>
          {{item._state}}
        </td>
        <td>
            {{item._progress}} 
        </td>
        <td>
            {{item._state_changed}}
        </td>
        <td>
          {{getTime()}}
        </td>
      </tr>
    <table>

   <h1>Profile Update Logs</h1>
      <table class="table table-striped">
      <tr>
        <th>User</th>
        <th>Service</th>
        <th>Service ID</th>
        <th>Achievements</th>
         <th>Minutes Ago</th>
      </tr>
      <tr ng-repeat="item in filteredLogs | orderBy:'-updated'"">
        <td>
          {{$index+1}}.
        </td>
        <td>
            {{item.service}} 
        </td>
        <td>
          {{item.id}}
        </td>
        <td>
            {{item.count}} 
        </td>
        <td>*{{ timePassed(item.updated) |number:2 }}*
          </td>
      </tr>
    <table>
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" type="text/css" />

  </body>
</html>